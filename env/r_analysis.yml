# Conda environment for R-based analysis
# Includes MagicalRsq, GENESIS for relatedness, and general R packages

name: r_analysis
channels:
  - conda-forge
  - bioconda
  - r
  - defaults

dependencies:
  # R and essential packages
  - r-base=4.3.1         # R version 4.3.1
  - r-essentials         # Core R packages

  # Data manipulation and visualization
  - r-tidyverse=2.0.0    # dplyr, ggplot2, tidyr, readr, etc.
  - r-data.table=1.14.8  # Fast data manipulation
  - r-reshape2           # Data reshaping

  # Bioconductor and genomics packages
  # Note: Some packages will need to be installed from Bioconductor within R
  - bioconductor-genomicranges
  - bioconductor-iranges
  - bioconductor-biobase
  - bioconductor-snprelate  # For genetic relationship analysis
  - bioconductor-gwastools  # GWAS utilities

  # GENESIS dependencies
  # Note: GENESIS itself needs to be installed from Bioconductor
  - bioconductor-seqarray
  - bioconductor-seqvartools
  - bioconductor-gdsfmt

  # Statistical packages
  - r-mass               # Statistical functions
  - r-matrix             # Matrix operations
  - r-lme4               # Mixed models
  - r-foreach            # Parallel processing
  - r-doparallel         # Parallel backend

  # Machine learning (for MagicalRsq)
  - r-xgboost=1.7.5.1    # XGBoost for MagicalRsq
  - r-caret              # Machine learning framework
  - r-proc               # ROC analysis

  # File I/O
  - r-vroom              # Fast file reading
  - r-readxl             # Read Excel files
  - r-writexl            # Write Excel files

  # Plotting
  - r-ggplot2=3.4.2
  - r-cowplot            # Publication-ready plots
  - r-patchwork          # Combining plots
  - r-viridis            # Color palettes
  - r-rcolorbrewer       # Color palettes

  # Utilities
  - r-devtools           # For installing R packages from GitHub
  - r-remotes            # Install packages from various sources
  - r-optparse           # Command-line argument parsing
  - r-yaml               # YAML file parsing
  - r-jsonlite           # JSON parsing

  # System dependencies
  - libgfortran5         # Fortran libraries (needed for some R packages)
  - libxml2              # XML parsing
  - libcurl              # Network operations
  - openssl              # Secure connections

  # Note: Additional R packages to install after environment creation:
  # Within R:
  # if (!require("BiocManager", quietly = TRUE))
  #     install.packages("BiocManager")
  #
  # BiocManager::install("GENESIS")
  #
  # # For MagicalRsq (if not available via conda)
  # devtools::install_github("quansun98/MagicalRsq")

# To create this environment:
# conda env create -f r_analysis.yml

# To activate:
# conda activate r_analysis

# Post-installation R commands (run in R):
# install.packages("BiocManager")
# BiocManager::install("GENESIS")
# 
# # MagicalRsq installation
# # Check if available on CRAN or Bioconductor, otherwise:
# library(devtools)
# install_github("quansun98/MagicalRsq")

# To test installation:
# R --version
# R -e "library(GENESIS); library(tidyverse); library(xgboost)"
