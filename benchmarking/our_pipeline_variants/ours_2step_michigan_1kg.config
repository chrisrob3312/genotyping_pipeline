/*
 * ours_2step_michigan_1kg.config
 *
 * Our Pipeline Variant F: 2-Step Imputation with Michigan 1000G Panel
 *
 * Pipeline Flow:
 *   Module 1: Union merge within platform → Minimal QC → Prep for imputation
 *   Module 2: Submit to Michigan Server (1000G) - PASS 1
 *   Module 3: Download results
 *   Module 4: Intersect merge across platforms
 *   Module 5: RE-IMPUTATION - PASS 2 (fills gaps from merge)
 *   Module 6: MagicalRsq-X filter → Thorough QC
 *   Module 7: GRAF-anc ancestry classification
 *
 * Key: Two imputation passes to recover variants lost in merge
 */

params {
    // =========================================================================
    // BENCHMARK IDENTIFIER
    // =========================================================================
    benchmark_name = 'ours_2step_michigan_1kg'
    benchmark_description = 'Our pipeline with 2-step imputation + Michigan 1000G + MagicalRsq-X'

    // =========================================================================
    // IMPUTATION SETTINGS
    // =========================================================================

    // Michigan 1000G imputation
    run_topmed = false
    run_anvil = false
    run_michigan = true
    michigan_panel = '1000g-phase3-v5'

    // ENABLE re-imputation (2-step approach)
    skip_reimputation = false
    run_michigan_reimputation = true

    // =========================================================================
    // QC SETTINGS
    // =========================================================================

    // Minimal QC before imputation
    pre_imputation_maf = 0.0
    pre_imputation_hwe = false

    // Thorough QC after imputation
    skip_hwe = true
    hwe_pvalue = 1e-6
    het_sd_threshold = 3
    use_genesis = true
    kinship_threshold = 0.177

    // =========================================================================
    // MAGICALRSQ-X SETTINGS
    // =========================================================================

    use_magicalrsq = true
    magicalrsq_threshold = 0.3
    primary_ancestry = 'EUR'

    // =========================================================================
    // OUTPUT SETTINGS
    // =========================================================================

    outdir = 'benchmarking/results/ours_2step_michigan_1kg'

    trace_report = true
    timeline_report = true
    dag_report = true
}

process {
    beforeScript = 'echo "START $(date +%s)" >> ${task.workDir}/timing.log'
    afterScript = 'echo "END $(date +%s)" >> ${task.workDir}/timing.log'
}
