/*
================================================================================
    OUR PIPELINE VARIANT: 1-Step Imputation with All of Us
================================================================================
    Uses All of Us AnVIL imputation server instead of TOPMed.
    Single imputation (no re-imputation after merge).

    All of Us advantages:
    - 50%+ non-European samples
    - Strong Latino/Hispanic representation
    - African American diversity
    - Good for admixed populations

    Use this to test: Does reference panel matter for our pipeline approach?
================================================================================
*/

params {
    // Benchmark identification
    benchmark_name = 'ours_1step_allofus'
    benchmark_description = 'Our pipeline (union → impute → merge → QC) with All of Us'

    // ========== Our Pipeline Approach ==========
    // Union merge within platform (keep all variants)
    // QC AFTER imputation (not before)
    // Single imputation pass

    // Module 2: Imputation
    run_topmed = false              // Disable TOPMed
    run_anvil = true                // Enable All of Us AnVIL

    // Module 5: Re-imputation
    skip_reimputation = true        // Skip re-imputation (1-step variant)
    run_topmed_reimputation = false
    run_anvil_reimputation = false

    // Module 3 & 6: QC (AFTER imputation)
    skip_hwe = true                 // Skip HWE for admixed populations
    use_magicalrsq = true           // Use MagicalRsq-X (ancestry-aware filtering)
    magicalrsq_threshold = 0.3

    // Ancestry-aware settings
    primary_ancestry = 'AMR'        // Optimize for admixed populations

    // Output
    outdir = 'results/benchmark_ours_1step_allofus'
}

// Profile for benchmarking
profiles {
    benchmark {
        process {
            // Add timing to all processes
            beforeScript = 'echo "START $(date +%s)" >> ${task.workDir}/timing.log'
            afterScript = 'echo "END $(date +%s)" >> ${task.workDir}/timing.log'
        }
    }
}
