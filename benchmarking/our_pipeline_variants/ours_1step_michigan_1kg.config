/*
 * ours_1step_michigan_1kg.config
 *
 * Our Pipeline Variant E: 1-Step Imputation with Michigan 1000G Panel
 *
 * Pipeline Flow:
 *   Module 1: Union merge within platform → Minimal QC → Prep for imputation
 *   Module 2: Submit to Michigan Imputation Server (1000G panel)
 *   Module 3: Download results
 *   Module 4: Intersect merge across platforms
 *   Module 5: SKIP (no re-imputation)
 *   Module 6: MagicalRsq-X filter → Thorough QC
 *   Module 7: GRAF-anc ancestry classification
 *
 * Note: Uses 1000G Phase 3 v5 panel via imputationbot
 */

params {
    // =========================================================================
    // BENCHMARK IDENTIFIER
    // =========================================================================
    benchmark_name = 'ours_1step_michigan_1kg'
    benchmark_description = 'Our pipeline with 1-step imputation + Michigan 1000G + MagicalRsq-X'

    // =========================================================================
    // IMPUTATION SETTINGS
    // =========================================================================

    // Michigan 1000G imputation
    run_topmed = false
    run_anvil = false
    run_michigan = true
    michigan_panel = '1000g-phase3-v5'

    // SKIP re-imputation (1-step only)
    skip_reimputation = true

    // =========================================================================
    // QC SETTINGS (Thorough QC AFTER imputation)
    // =========================================================================

    // Minimal QC before imputation (Module 1)
    pre_imputation_maf = 0.0      // Don't filter rare variants before imputation
    pre_imputation_hwe = false    // Don't filter HWE before imputation

    // Thorough QC after imputation (Module 6)
    skip_hwe = true               // Skip HWE for admixed populations
    hwe_pvalue = 1e-6
    het_sd_threshold = 3
    use_genesis = true
    kinship_threshold = 0.177

    // =========================================================================
    // MAGICALRSQ-X SETTINGS
    // =========================================================================

    use_magicalrsq = true
    magicalrsq_threshold = 0.3
    primary_ancestry = 'EUR'      // 1000G has good EUR coverage

    // =========================================================================
    // OUTPUT SETTINGS
    // =========================================================================

    outdir = 'benchmarking/results/ours_1step_michigan_1kg'

    trace_report = true
    timeline_report = true
    dag_report = true
}

process {
    beforeScript = 'echo "START $(date +%s)" >> ${task.workDir}/timing.log'
    afterScript = 'echo "END $(date +%s)" >> ${task.workDir}/timing.log'
}
